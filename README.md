# Product Requirements Document (PRD): ArgusV2
**GitLab AI Hackathon Edition**

_Status legend:_ `Current` = implemented in this repository today, `Target` = planned end-state.

## 1. Project Overview & Vision
Argus is an autonomous, zero-config compliance infrastructure designed to monopolize the "trust layer" for mission-critical Python code. It acts as an event-driven DevSecOps gateway that utilizes a Neuro-Symbolic Repair Loop, combining the generative reasoning of Gemini with strict mathematical formal verification in Lean 4.

Instead of traditional linting, Argus aims to prove that critical software bugs (for example, floating-point errors and unauthorized state transitions) are mathematically impossible before code is merged. The objective is to transform bespoke formal verification workflows into an automated, out-of-the-box CI/CD integration for regulated software teams.

## 2. Hackathon Objectives & Prize Alignment
* **Primary Category:** GitLab Custom Agents & Flows (eliminating friction from the Software Development Lifecycle).
* **Bonus Target:** Google Cloud + GitLab integration prize (using Gemini as the cognitive engine).
* **Venture/Thiel Target:** Demonstrate enterprise viability through native platform integration that can scale across many teams.

## 3. Architecture & Tech Stack

| Component | Technology | Role | Status |
| :--- | :--- | :--- | :--- |
| **Platform / Trigger** | GitLab Duo Agent Platform | Event listener and CI/CD integration surface. | Current (baseline) |
| **Cognitive Engine** | Google Gemini API | Reads Python diffs, extracts logic, and supports translation/repair steps. | Current |
| **Verification Engine** | Lean 4 (via `elan`) + Dafny | Formal verification backends for obligations generated by the pipeline. | Current |
| **Orchestrator** | Python modules in `src/` | Glue code between repo analysis, translation, verification, and reporting. | Current |
| **Flow Packaging** | Duo flow YAML + CI pipeline composition | Native flow-level wiring for full MR automation. | Target |

### Current Repository Snapshot (`Current`)
```text
├── .gitlab/
│   └── duo/
│       └── agent-config.yml
├── src/
│   ├── adapters/
│   ├── core/
│   │   ├── translator/
│   │   └── verifier/
│   ├── prompts/
│   └── utils/
├── tests/
├── benchmarks/
├── lean_project/
├── demo_target/                       # Placeholder directory for demo targets
├── legacy/                            # Archived ArgusV1 codebase
├── Dockerfile
└── requirements.txt
```

### Target Directory Structure (`Target`)
```text
├── .gitlab/
│   ├── duo/
│   │   └── flows/
│   │       └── argus_verify.yaml      # Target: core GitLab Duo Flow definition
│   └── ci/
│       └── verify-pipeline.yml        # Target: CI pipeline containing Lean 4 environment
├── src/
│   ├── orchestrator.py                # Target: single orchestration entrypoint
│   ├── prompts/
│   │   ├── extract_invariants.txt     # Target: few-shot prompts for Gemini
│   │   └── repair_loop.txt            # Target: Lean error -> Gemini repair prompts
│   └── tools/
│       └── gitlab_client.py           # Target: handles MR comments/labels/approvals
├── demo_target/                       # Target: sample vulnerable code for demo video
│   ├── fintech_ledger.py
│   └── auth_state.py
├── Dockerfile
└── requirements.txt
```
